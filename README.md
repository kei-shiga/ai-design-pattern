# AIを活用したシステム開発手法のデザインパターンと知見集

## 1. 概要

本資料は、GitHub CopilotやChatGPT、CursorなどのAIツールを開発プロセスに組み込む際に直面する「開発手法上の問題点」と、それに対する「知見・対応策」をまとめたものです。AIによる自動生成がもたらす速度向上と、品質・保守性のトレードオフを解消することを目的としています。

### パターン一覧

| 項番 | パターン名 | 概要 |
| :--- | :--- | :--- |
| 2.1 | **AI-TDD** | 実装前にテスト作成またはAIにテストを書かせ、テスト通過ループで品質を担保する |
| 2.2 | **Small-Step Generation** | 複雑な機能を「人間がレビュー可能な最小単位」に分割して反復生成する |
| 3.1 | **Context Injection** | `README`や`.cursorrules`等でプロジェクト固有の文脈・規約をAIに注入する |
| 3.2 | **Prompt Snippets** | 効果的なプロンプトをコード資産としてリポジトリ管理・共有する |
| 4.1 | **AI-Augmented Review** | 人間のレビュー前にAIエージェントによる一次チェックを挟み、負荷を下げる |
| 4.2 | **Selective Generation** | コアロジックは人間、ボイラープレートはAIと明確に役割分担する |
| 5.1 | **CodeAct** | 自然言語推論ではなく、実行可能なコード(C#等)を書いて検証した結果を回答とする |
| 5.2 | **Reflection** | AI自身に「バグはないか？」と自己評価・修正させてからユーザーに提示する |
| 6.1 | **RAG-based Coding** | 大規模リポジトリから関連コードを動的検索し、コンテキストとして注入する |
| 6.2 | **Self-Healing Workflows** | CI/CDのエラーログをAIが解析し、自動で修正パッチを作成・適用する |

---

## 2. コード品質・正確性の問題に対するパターン

AIは「動くコード」を生成しますが、論理的な誤りや保守性の欠如が含まれることがあります。

### 2.1 AI-TDD (AI-Driven Test Driven Development)

* **問題:** AIが生成したコードに、一見正しく見えるが微妙なバグ（ハルシネーション）が混入する。
* **知見・対応案:**
* AIに実装コードを書かせる前に、まず**AI自身にテストコードを書かせる**、あるいは人間がテストを定義する。
* 「テストが通るまでAIに修正させる」というループを回すことで、実装のブラックボックス化を防ぎ、品質を担保する。


### 2.2 Small-Step Generation（小歩進生成）

* **問題:** 複雑な要件を一度にAIに渡すと、内部ロジックが破綻したり、アーキテクチャが無視されたりする。
* **知見・対応案:**
* 機能を「クラス単位」「関数単位」など、人間がレビュー可能な最小単位まで分割して生成・コミットを繰り返す。
* 人間が「設計の舵取り（ディレクトリ構造やインターフェースの定義）」に専念し、AIを「詳細実装のタイピスト」として扱う境界線を明確にする。

---

## 3. 文脈（コンテキスト）と一貫性の問題に対するパターン

AIはプロジェクト全体の規約や、特定のライブラリの使い方を「暗黙の了解」として理解できません。

### 3.1 Context Injection / Repository-Aware Prompting

* **問題:** プロジェクト固有のコーディング規約や、非推奨のライブラリ、プロジェクト特有の命名規則が無視される。
* **知見・対応案:**
* `README.md` や `.cursorrules` などの設定ファイルに、プロジェクトの技術スタック、アーキテクチャ方針、禁止事項を明文化してAIに常時参照させる。
* AIが参照すべき「参考コード（お手本）」を明示的にプロンプトに含めることで、コードのトーン＆マナーを統一する。


### 3.2 Prompt Snippets / Prompt Engineering as Code

* **問題:** 優れたコードを生成できるプロンプトが特定の個人に属人化し、チーム全体で開発効率に差が出る。
* **知見・対応案:**
* 「コードレビュー用」「リファクタリング用」「ドキュメント生成用」など、効果が高かったプロンプトをスニペットとして共有・管理する。
* プロンプトを「コードの一部」としてリポジトリに含め、バージョン管理の対象とする。

---

## 4. レビューとチーム運用におけるパターン

AIによる高速なコード生成が、人間のレビュー能力を上回ってしまう問題（レビューのボトルネック）への対処です。

### 4.1 AI-Augmented Review（AIによる多層レビュー）

* **問題:** AIが生成した大量のプルリクエストを人間が精査しきれず、結果として技術負債が急増する。
* **知見・対応案:**
* 人間がレビューする前に、**別のAI（あるいは異なるLLMモデル）に一次レビューをさせる**。
* セキュリティ脆弱性、命名規則違反、構文エラーなどの機械的なチェックをAIに担当させ、人間は「業務ロジックの妥当性」や「意図の確認」に集中する。


### 4.2 Selective Generation（選択的生成）

* **問題:** 全てのコードをAIに書かせると、トラブル発生時に誰も中身を理解しておらず、修正できなくなる。
* **知見・対応案:**
* 「コアなビジネスロジック」は人間が主導して書き、「ボイラープレート（定型文）」「ユーティリティ関数」「テストデータ作成」などはAIに任せるという、役割分担のポリシーをチームで合意する。

---

## 5. 自律エージェント的アプローチ

AIを単なるチャットボットではなく、自律的なエージェントとして振る舞わせるパターンです。

### 5.1 CodeAct (Executable Code as Reasoning)

* **問題:** 複雑な論理推論や計算を自然言語だけで行わせると、もっともらしい嘘（ハルシネーション）をつくことがある。
* **知見・対応案:**
* AIに自然言語で考えさせるのではなく、**「実行可能なコード（C#等）」を書かせ、それを実際にサンドボックスで実行した結果**を元に回答させる。
* 「考える」ことと「計算する」ことを分離し、確実なロジック処理はコードに委譲する。


### 5.2 Reflection / Self-Critique (自己反省ループ)

* **問題:** AIは一度の生成（One-shot）で完璧な答えを出そうとするが、考慮漏れやケアレスミスが発生しやすい。
* **知見・対応案:**
* 生成結果を即座にユーザーに見せるのではなく、AI自身に**「このコードにバグはないか？」「要件を全て満たしているか？」と問いかけ（Re-prompting）**、修正してから出力するプロセスを自動化する。
* 「作成者（Coder）」と「批評家（Critic）」のロールを内部的に分ける。

---

## 6. アーキテクチャと運用自動化

開発環境や運用環境全体をAI前提で再構築するパターンです。

### 6.1 RAG-based Coding (Retrieval-Augmented Generation)

* **問題:** コンテキストウィンドウ（入力トークン数）の制限により、大規模なリポジトリ全体の知識を一度にAIに渡すことができない。
* **知見・対応案:**
* コードベースや社内ドキュメントをベクトル化してDBに保存し、質問に関連する部分だけを**動的に検索（Retrieve）してプロンプトに注入**する。
* ファイル単位ではなく、関数やクラス単位の「意味的な塊（Chunk）」で検索インデックスを作成する。


### 6.2 Self-Healing Workflows (自己修復ワークフロー)

* **問題:** CI/CDパイプラインでのビルドエラーやテスト失敗のたびに、人間がログを確認して修正するのは非効率である。
* **知見・対応案:**
* エラー発生時に、AIが自動的にログを解析し、修正パッチを作成してPRを出す、あるいは再実行する自律ループを構築する。
* 特に「依存関係の更新」や「Lintエラーの修正」など、機械的な対応が可能な領域で効果を発揮する。

---

## 7. 体系的なリソース・用語

本分野をさらに深く学習するためのキーワードです。

* **AASE (AI-Augmented Software Engineering):** AIによって強化されたソフトウェア工学の総称。
* **LLM-based Refactoring:** 大規模言語モデルを用いた安全なコード改善の手法。
* **Human-AI Collaboration Patterns:** 人間とAIが効率的に共同作業を行うための役割分担モデル。
* **Agentic Patterns:** ReAct, Plan-and-Execute, Multi-Agentなどのエージェント動作モデル。

---

## 8. まとめ

AIを使った開発手法の要諦は、**「AIに主体性を渡さず、人間がレビューと設計の主導権を握るための構造を作る」**ことにあります。これらのパターンを導入することで、開発スピードを維持したまま、システムの堅牢性を確保することが可能になります。
