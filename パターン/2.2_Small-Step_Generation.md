# 2.2 Small-Step Generation (小歩進生成)

## 概要
複雑な要件を一度にAIに渡すと、コンテキストウィンドウの制限や推論能力の限界により、内部ロジックが破綻したりアーキテクチャが無視されたりします。これを防ぐため、**機能を「人間がレビュー可能な最小単位」まで分割して生成・コミットを繰り返す**手法です。

## 詳細・実施手順

1. **分解 (Decomposition):**
   * 大きなタスク（例：「ログイン機能の実装」）を、小さなサブタスク（例：「DBスキーマ定義」「認証Utility関数」「ログインAPIエンドポイント」「UIコンポーネント」）に分割します。

2. **計画 (Implementation Plan):**
   * AIに「実装計画書」を作成させ、手順の妥当性を人間がレビューします。
   * この計画書自体をMarkdownファイルとして保存し、進捗管理に使用します。

3. **反復生成 (Iterative Generation):**
   * サブタスク1つずつについて、AIにコード生成を依頼します。
   * 生成されたコードを人間がレビューし、問題なければコミットします。
   * 「次のステップ」に進む際、前のステップで作成したファイルやコードをコンテキストとして与えます。

## 実装計画書の例 (Markdown)

AIに最初に作成させる実装計画のテンプレート例です。

```markdown
# 実装計画: Todoリストアプリ

## Phase 1: データモデル
- [ ] `models/todo.py`: Todoアイテムのクラス定義 (id, title, completed)
- [ ] `models/db_manager.py`: SQLiteへの保存・読み込み処理

## Phase 2: バックエンドAPI
- [ ] `api/server.py`: Flask/FastAPIのセットアップ
- [ ] `api/routes.py`: GET /todos, POST /todos の実装

## Phase 3: フロントエンド
- [ ] `static/index.html`: 基本的なUI構造
- [ ] `static/app.js`: APIとの通信ロジック
```

## サンプルプロンプト (Step-by-Step)

**Step 1: 計画作成**
```markdown
これから「ユーザー管理システム」を作りたいです。
必要なファイルをリストアップし、実装する順番を定義した「実装計画」を作成してください。
いきなりコードは書かず、まずは計画のみを提示してください。
```

**Step 2: 個別実装**
```markdown
実装計画の項番1である「`user.py` (Userクラスの定義)」を実装してください。
以下の要件を含めてください：
- ID, 名前, メールアドレスを持つ
- メールアドレスのバリデーションを行う
```

## メリット
- **レビュー負荷の軽減:** 変更差分が小さくなるため、人間がコードの内容を把握しやすくなります。
- **手戻りの最小化:** 初期の設計ミスに早い段階で気づくことができます。
- **コンテキスト維持:** 一度の生成量が少ないため、AIが前の文脈を忘れずに一貫性のあるコードを生成できます。
