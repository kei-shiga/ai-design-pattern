# 3.2 Prompt Snippets / Prompt Engineering as Code

## 概要
優れたコードを生成できるプロンプトが特定の個人に属人化してしまう問題を防ぐため、**プロンプトを「コードの一部」としてリポジトリに含め、バージョン管理・共有**します。効果的だったプロンプトをチーム資産として再利用可能にします。

## 詳細・実施手順

1. **プロンプトの収集:**
   * 開発チーム内で「うまくいったプロンプト」「失敗したプロンプト」を共有します。
   * コードレビュー依頼用、リファクタリング用、単体テスト生成用など、用途別に分類します。

2. **スニペット化・保存:**
   * リポジトリ内に `.prompts/` や `docs/prompts/` ディレクトリを作成します。
   * Markdown形式などでプロンプトを保存します。
   * VSCodeやCursorのスニペット機能、または辞書登録を活用して、呼び出しやすくします。

3. **改善とバージョン管理:**
   * AIモデルの進化に合わせてプロンプトもアップデートします。
   * Gitで管理することで、「いつ、どのようにプロンプトを変えたら結果が良くなったか」を追跡できます。

## ディレクトリ構成例

```text
my-project/
├─ src/
├─ tests/
├─ .prompts/
│  ├─ refactor_code.md   # リファクタリング用
│  ├─ generate_test.md   # テスト生成用
│  ├─ write_docs.md      # ドキュメント生成用
│  └─ code_review.md     # レビュー依頼用
└─ README.md
```

## プロンプトスニペット例

### `refactor_code.md` (リファクタリング用)
```markdown
# Request
以下のコードをリファクタリングしてください。

# Focus Points
1. **可読性:** 変数名や関数名をより意図が伝わるものに変更する。
2. **複雑度:** ネストが深い `if/else` をガード節 (Guard Clauses) を使ってフラットにする。
3. **パフォーマンス:** 無駄なループや計算があれば最適化する。
   *ただし、可読性を著しく損なう過度な最適化は避けること。*
4. **安全性:** 例外処理が足りない箇所があれば追加する。

# Target Code
{{PASTE_CODE_HERE}}
```

### `generate_test.md` (テスト生成用)
```markdown
# Request
添付のコードに対するユニットテストを作成してください。

# Requirements
- テストフレームワーク: {{TEST_FRAMEWORK}} (e.g., Jest, Pytest)
- 正常系だけでなく、以下の異常系もカバーすること:
   - Null または Undefined の入力
   - 空文字、空リスト
   - 境界値 (0, 負数, 最大値)
- テストケース名は「Given-When-Then」形式で記述すること。
- モックが必要な外部依存（DB, API）は明示的にモック化すること。
```

## メリット
- **品質の均質化:** ジュニアエンジニアでもシニアエンジニアと同じレベルのAI活用出力が得られやすくなります。
- **ナレッジの蓄積:** 「どう頼めばAIが良い仕事をするか」というノウハウが組織に残ります。
- **効率化:** 毎回ゼロからプロンプトを考える時間を削減できます。
